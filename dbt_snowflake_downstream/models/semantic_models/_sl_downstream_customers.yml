semantic_models:
- name: downstream_customers
  description: This model retrieves all customer data from the 'secret.customers'
    table, providing a comprehensive view of customer information for downstream analysis
    and reporting.
  model: ref('secret', 'customers')
  defaults:
    agg_time_dimension: first_order_date

  entities:
  - name: customer
    type: primary
    expr: customer_id
  dimensions:
  - name: customer_name
    type: categorical
  - name: first_order_date
    type: time
    type_params:
      time_granularity: day
  - name: most_recent_order_date
    type: time
    type_params:
      time_granularity: day
  measures:
  - name: number_of_orders
    description: The total number of orders placed by the customer.
    agg: sum
  - name: lifetime_value
    description: The total value of the customer's transactions over their lifetime.
    agg: sum
  - name: count_distinct_customers
    agg: count
    expr: customer_id

metrics:
  - name: met_count_distinct_customers
    description: "Count of customers"
    type: simple
    label: "customers"
    type_params:
      measure: count_distinct_customers
  - name: met_customer_lifetime_value
    description: "Lifetime value"
    type: simple
    label: "Customer Lifetime Value"
    type_params:
      measure: lifetime_value